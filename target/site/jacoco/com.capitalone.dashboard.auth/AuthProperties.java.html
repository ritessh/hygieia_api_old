<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AuthProperties.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.capitalone.dashboard:api</a> &gt; <a href="index.source.html" class="el_package">com.capitalone.dashboard.auth</a> &gt; <span class="el_source">AuthProperties.java</span></div><h1>AuthProperties.java</h1><pre class="source lang-java linenums">package com.capitalone.dashboard.auth;

import java.util.List;
import java.util.UUID;

import javax.annotation.PostConstruct;

import org.apache.commons.collections.CollectionUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.stereotype.Component;

import com.capitalone.dashboard.model.AuthType;
import com.google.common.collect.Lists;

@Component
@EnableConfigurationProperties
@ConfigurationProperties(prefix = &quot;auth&quot;)
<span class="fc" id="L21">public class AuthProperties {</span>

<span class="fc" id="L23">	private static final Logger LOGGER = LoggerFactory.getLogger(AuthProperties.class);</span>

	private Long expirationTime;
	private String secret;
	private String ldapUserDnPattern;
	private String ldapServerUrl;
<span class="fc" id="L29">	private List&lt;AuthType&gt; authenticationProviders = Lists.newArrayList();</span>

	private String openIdClientId;
	private String openIdClientSecret;
	private String openIdServerHost;
	private String openIdRedirectUri;
	private String openIdGrantType;
	private String openIdScope;

	private String adDomain;
	private String adRootDn;
	private String adUserRootDn;
	private String adSvcRootDn;
	private String adUrl;

	private String ldapBindUser;
	private String ldapBindPass;

<span class="fc" id="L47">	private boolean ldapDisableGroupAuthorization = false;</span>

	/**
	 * The LDAP filter used to search for users (optional). For example &quot;(&amp;(objectClass=user)(sAMAccountName={0}))&quot;. The
	 * substituted parameter is the user's login name.
	 **/
	private String ldapUserSearchFilter;

	/**
	 * Username (DN) of the &quot;manager&quot; user identity (i.e. &quot;uid=admin,ou=system&quot;) which
	 * will be used to authenticate to a (non-embedded) LDAP server. If omitted,
	 * anonymous access will be used.
	 **/
	private String ldapManagerDn;

	/**
	 * The password for the manager DN. This is required if the ldapManagerDn is
	 * specified.
	 **/
	private String ldapManagerPassword;

	// -- SSO properties
	private String userEid;
	private String userEmail;
	private String userFirstName;
	private String userLastName;
	private String userMiddelInitials;
	private String userDisplayName;
	//-- end SSO properties

	public Long getExpirationTime() {
<span class="fc" id="L78">		return expirationTime;</span>
	}

	public void setExpirationTime(Long expirationTime) {
<span class="fc" id="L82">		this.expirationTime = expirationTime;</span>
<span class="fc" id="L83">	}</span>

	public String getSecret() {
<span class="fc" id="L86">		return secret;</span>
	}

	public void setSecret(String secret) {
<span class="fc" id="L90">		this.secret = secret;</span>
<span class="fc" id="L91">	}</span>

	public String getLdapUserDnPattern() {
<span class="fc" id="L94">		return ldapUserDnPattern;</span>
	}

	public void setLdapUserDnPattern(String ldapUserDnPattern) {
<span class="fc" id="L98">		this.ldapUserDnPattern = ldapUserDnPattern;</span>
<span class="fc" id="L99">	}</span>

	public String getLdapServerUrl() {
<span class="fc" id="L102">		return ldapServerUrl;</span>
	}

	public void setLdapServerUrl(String ldapServerUrl) {
<span class="fc" id="L106">		this.ldapServerUrl = ldapServerUrl;</span>
<span class="fc" id="L107">	}</span>

	public List&lt;AuthType&gt; getAuthenticationProviders() {
<span class="fc" id="L110">		return authenticationProviders;</span>
	}

	public void setAuthenticationProviders(List&lt;AuthType&gt; authenticationProviders) {
<span class="nc" id="L114">		this.authenticationProviders = authenticationProviders;</span>
<span class="nc" id="L115">	}</span>

	public String getAdDomain() {
<span class="fc" id="L118">		return adDomain;</span>
	}

	public void setAdDomain(String adDomain) {
<span class="fc" id="L122">		this.adDomain = adDomain;</span>
<span class="fc" id="L123">	}</span>

	public String getAdRootDn() {
<span class="fc" id="L126">		return adRootDn;</span>
	}

	public void setAdRootDn(String adRootDn) {
<span class="fc" id="L130">		this.adRootDn = adRootDn;</span>
<span class="fc" id="L131">	}</span>

	public String getAdUserRootDn() {
<span class="fc" id="L134">		return adUserRootDn;</span>
	}

	public void setAdUserRootDn(String adUserRootDn) {
<span class="nc" id="L138">		this.adUserRootDn = adUserRootDn;</span>
<span class="nc" id="L139">	}</span>

	public String getAdSvcRootDn() {
<span class="fc" id="L142">		return adSvcRootDn;</span>
	}

	public void setAdSvcRootDn(String adSvcRootDn) {
<span class="nc" id="L146">		this.adSvcRootDn = adSvcRootDn;</span>
<span class="nc" id="L147">	}</span>

	public String getAdUrl() {
<span class="fc" id="L150">		return adUrl;</span>
	}

	public void setAdUrl(String adUrl) {
<span class="fc" id="L154">		this.adUrl = adUrl;</span>
<span class="fc" id="L155">	}</span>

	public String getLdapBindUser() {
<span class="nc" id="L158">		return ldapBindUser;</span>
	}

	public void setLdapBindUser(String ldapBindUser) {
<span class="fc" id="L162">		this.ldapBindUser = ldapBindUser;</span>
<span class="fc" id="L163">	}</span>

	public String getLdapBindPass() {
<span class="nc" id="L166">		return ldapBindPass;</span>
	}

	public void setLdapBindPass(String ldapBindPass) {
<span class="fc" id="L170">		this.ldapBindPass = ldapBindPass;</span>
<span class="fc" id="L171">	}</span>

	public boolean isLdapDisableGroupAuthorization() {
<span class="nc" id="L174">		return ldapDisableGroupAuthorization;</span>
	}

	public void setLdapDisableGroupAuthorization(boolean ldapDisableGroupAuthorization) {
<span class="nc" id="L178">		this.ldapDisableGroupAuthorization = ldapDisableGroupAuthorization;</span>
<span class="nc" id="L179">	}</span>

	public String getLdapUserSearchFilter() {
<span class="nc" id="L182">		return ldapUserSearchFilter;</span>
	}

	public void setLdapUserSearchFilter(String ldapUserSearchFilter) {
<span class="nc" id="L186">		this.ldapUserSearchFilter = ldapUserSearchFilter;</span>
<span class="nc" id="L187">	}</span>

	public String getLdapManagerDn() {
<span class="nc" id="L190">		return ldapManagerDn;</span>
	}

	public void setLdapManagerDn(String ldapManagerDn) {
<span class="nc" id="L194">		this.ldapManagerDn = ldapManagerDn;</span>
<span class="nc" id="L195">	}</span>

	public String getLdapManagerPassword() {
<span class="nc" id="L198">		return ldapManagerPassword;</span>
	}

	public void setLdapManagerPassword(String ldapManagerPassword) {
<span class="nc" id="L202">		this.ldapManagerPassword = ldapManagerPassword;</span>
<span class="nc" id="L203">	}</span>

	@PostConstruct
	public void applyDefaultsIfNeeded() {
<span class="fc bfc" id="L207" title="All 2 branches covered.">		if (getSecret() == null) {</span>
<span class="fc" id="L208">			LOGGER.info(&quot;No JWT secret found in configuration, generating random secret by default.&quot;);</span>
<span class="fc" id="L209">			setSecret(UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;&quot;));</span>
		}

<span class="fc bfc" id="L212" title="All 2 branches covered.">		if (getExpirationTime() == null) {</span>
<span class="fc" id="L213">			LOGGER.info(&quot;No JWT expiration time found in configuration, setting to 30 minutes.&quot;);</span>
<span class="fc" id="L214">			setExpirationTime((long) 1000 * 60 * 30);</span>
		}

<span class="pc bpc" id="L217" title="1 of 2 branches missed.">		if (CollectionUtils.isEmpty(authenticationProviders)) {</span>
<span class="fc" id="L218">			authenticationProviders.add(AuthType.STANDARD);</span>
		}
<span class="fc" id="L220">	}</span>

	public String getUserEid() {
<span class="nc" id="L223">		return userEid;</span>
	}

	public void setUserEid(String userEid) {
<span class="nc" id="L227">		this.userEid = userEid;</span>
<span class="nc" id="L228">	}</span>

	public String getUserEmail() {
<span class="nc" id="L231">		return userEmail;</span>
	}

	public void setUserEmail(String userEmail) {
<span class="nc" id="L235">		this.userEmail = userEmail;</span>
<span class="nc" id="L236">	}</span>

	public String getUserFirstName() {
<span class="nc" id="L239">		return userFirstName;</span>
	}

	public void setUserFirstName(String userFirstName) {
<span class="nc" id="L243">		this.userFirstName = userFirstName;</span>
<span class="nc" id="L244">	}</span>

	public String getUserLastName() {
<span class="nc" id="L247">		return userLastName;</span>
	}

	public void setUserLastName(String userLastName) {
<span class="nc" id="L251">		this.userLastName = userLastName;</span>
<span class="nc" id="L252">	}</span>

	public String getUserMiddelInitials() {
<span class="nc" id="L255">		return userMiddelInitials;</span>
	}

	public void setUserMiddelInitials(String userMiddelInitials) {
<span class="nc" id="L259">		this.userMiddelInitials = userMiddelInitials;</span>
<span class="nc" id="L260">	}</span>

	public String getUserDisplayName() {
<span class="nc" id="L263">		return userDisplayName;</span>
	}

	public void setUserDisplayName(String userDisplayName) {
<span class="nc" id="L267">		this.userDisplayName = userDisplayName;</span>
<span class="nc" id="L268">	}</span>

	public String getOpenIdServerHost() {
<span class="fc" id="L271">		return openIdServerHost;</span>
	}

	public void setOpenIdServerHost(String openIdServerHost) {
<span class="nc" id="L275">		this.openIdServerHost = openIdServerHost;</span>
<span class="nc" id="L276">	}</span>

	public String getOpenIdClientId() {
<span class="fc" id="L279">		return openIdClientId;</span>
	}

	public void setOpenIdClientId(String openIdClientId) {
<span class="nc" id="L283">		this.openIdClientId = openIdClientId;</span>
<span class="nc" id="L284">	}</span>

	public String getOpenIdClientSecret() {
<span class="fc" id="L287">		return openIdClientSecret;</span>
	}

	public void setOpenIdClientSecret(String openIdClientSecret) {
<span class="nc" id="L291">		this.openIdClientSecret = openIdClientSecret;</span>
<span class="nc" id="L292">	}</span>

	public String getOpenIdRedirectUri() {
<span class="fc" id="L295">		return openIdRedirectUri;</span>
	}

	public void setOpenIdRedirectUri(String openIdRedirectUri) {
<span class="nc" id="L299">		this.openIdRedirectUri = openIdRedirectUri;</span>
<span class="nc" id="L300">	}</span>

	public String getOpenIdGrantType() {
<span class="fc" id="L303">		return openIdGrantType;</span>
	}

	public void setOpenIdGrantType(String openIdGrantType) {
<span class="nc" id="L307">		this.openIdGrantType = openIdGrantType;</span>
<span class="nc" id="L308">	}</span>

	public String getOpenIdScope() {
<span class="fc" id="L311">		return openIdScope;</span>
	}

	public void setOpenIdScope(String openIdScope) {
<span class="nc" id="L315">		this.openIdScope = openIdScope;</span>
<span class="nc" id="L316">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>